apiVersion: v1
kind: Secret
metadata:
  name: "resultsdb-test-{{ resultsdb_test_id }}-config"
  labels:
    environment: "test-{{ resultsdb_test_id }}"
    app: resultsdb
stringData:
  settings.py: |-
    SECRET_KEY = '{{ resultsdb_secret_key }}'
    SQLALCHEMY_DATABASE_URI = 'postgresql+psycopg2://resultsdb:{{ resultsdb_db_password }}@resultsdb-test-{{ resultsdb_test_id }}-database:5432/resultsdb'
    FILE_LOGGING = False
    LOGFILE = '/var/log/resultsdb/resultsdb.log'
    SYSLOG_LOGGING = False
    STREAM_LOGGING = True
    RUN_HOST= '0.0.0.0'
    RUN_PORT = 5001
    MESSAGE_BUS_PUBLISH = {{ resultsdb_publish | bool }}
    MESSAGE_BUS_PLUGIN = 'fedmsg'
    MESSAGE_BUS_KWARGS = {'modname': 'resultsdb'}
    ADDITIONAL_RESULT_OUTCOMES = {{ resultsdb_additional_result_outcomes }}
    # Credentials are resultsdb-updater:password
  .htpasswd: |-
    resultsdb-updater:{{ resultsdb_password }}